<?php

namespace Appstore\Bundle\MedicineBundle\Repository;
use Appstore\Bundle\MedicineBundle\Entity\MedicineParticularType;
use Doctrine\ORM\EntityRepository;
use Setting\Bundle\ToolBundle\Entity\GlobalOption;


/**
 * MedicineReverseRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class MedicineParticularTypeRepository extends EntityRepository
{
    public function getApiCategory(GlobalOption $option)
    {

        $config = $option->getMedicineConfig()->getId();
        $qb = $this->createQueryBuilder('e');
        $qb->where("e.slug != 'rack'");
        $result = $qb->getQuery()->getResult();

        $data = array();

        /* @var $row MedicineParticularType */

        foreach($result as $key => $row) {

            $data[$key]['category_id']    = (int) $row->getId();
            $data[$key]['name']           = $row->getName();
            $data[$key]['slug']           = $row->getSlug();

        }

        return $data;
    }
}
