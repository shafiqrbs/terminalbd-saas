<?php

namespace Appstore\Bundle\MedicineBundle\Repository;


use Appstore\Bundle\MedicineBundle\Entity\MedicineGeneric;
use Doctrine\ORM\EntityRepository;

/**
 * GenericRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class MedicineMinimumStockRepository extends EntityRepository
{
    public function companyList($config){

        $query = $this->_em->createQueryBuilder();
        $query->from('MedicineBundle:MedicineStock','e');
        $query->select('e.brandName as name');
        $query->where("e.medicineConfig = :config")->setParameter('config', $config);
        $query->andWhere('e.brandName IS NOT NULL');
        $query->groupBy('e.brandName');
        $query->orderBy('e.brandName', 'ASC');
        $array = array();
        $results = $query->getQuery()->getArrayResult();
        foreach ($results as $row){
            $array [$row['name']] =$row['name'];
        }
        return $array;
    }
    public function medicineFormList(){


        $stock = "SELECT medicineForm as name FROM `medicine_brand`  WHERE medicineForm NOT IN (',',',,',',.',':',';','.','0','1','..',',',' ')  GROUP BY `medicineForm`  
ORDER BY `medicineForm`  ASC";
        $qb1 = $this->getEntityManager()->getConnection()->prepare($stock);
        $qb1->execute();
        $results =  $qb1->fetchAll();
        foreach ($results as $row){
            $array [$row['name']] =$row['name'];
        }
        return $array;
    }
}
