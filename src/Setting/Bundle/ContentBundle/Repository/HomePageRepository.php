<?php

namespace Setting\Bundle\ContentBundle\Repository;

use Doctrine\ORM\EntityRepository;
use Setting\Bundle\AppearanceBundle\Entity\Menu;

/**
 * HomePageRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class HomePageRepository extends EntityRepository
{

    public function globalOptionHome($user)
    {
        $em = $this->_em;

        $reEntity = $em->getRepository('SettingContentBundle:HomePage')->findOneBy(array('user'=>$user));
        if(empty($reEntity) && $user){

            $entity = New HomePage();
            $entity->setUser($user);
            $entity->setName("Home");
            $em->persist($entity);

            $entity = New Menu();
            $entity->setMenu('Home');
            $entity->setMenuSlug('home');
            $entity->setUser($user);
            $entity->setDefaultMenu(true);
            $em->persist($entity);

            $em->flush();
        }


    }


}
